from typing import Any

from .dbs import get_collection


async def read_vulnerabilities_by_package_and_version(package_name: str, version_name: str) -> dict[str, Any]:
    vulnerabilities_collection = get_collection("vulnerabilities")
    result = await vulnerabilities_collection.find(
        {
            "affected.package.name": package_name,
            "affected.versions": version_name
        }
    ).to_list(length=None)
    return result if result else {}
